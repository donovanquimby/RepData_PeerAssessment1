p4a <- qplot(sum, interval, data = weekdays) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
grid.arrange(p4a, p4b, nrow =1)
grid.arrange(p4a, p4b, nrow =1)
p4a <- ggplot(sum, interval, data = weekdays) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4a <- qplot(sum, interval, data = weekdays, alpha = 1/10) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4a <- qplot(sum, interval, data = weekdays, alpha = 1/10) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = 1/10) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays, colour = grey) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = 1/10) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays, colour = 'grey') + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = 1/10) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/10)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/1000)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/1000)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/10)) + geom_line( size = 1) +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/10)) + geom_line( size = 1) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sumByDay, group = 1)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- ggplot(data = weekend, aes(x = interval, y = sumByDay, group = 1)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(arrangeGrob(p4a, p4b), nrow =1)
grid.arrange(arrangeGrob(p4a, p4b nrow =1))
grid.arrange(arrangeGrob(p4a, p4b, nrow =1))
p4a <- ggplot(data = weekdays, aes(x = interval, y = sumByDay, group = 1)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- ggplot(data = weekend, aes(x = interval, y = sumByDay, group = 1)) + geom_line( size = 1, colour = 'cyan') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrp4a
p4a
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) + geom_line( size = 1, colour = 'cyan') +
+ geom_smooth(span = 0.25)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'cyan') + geom_smooth(span = 0.25)
p4a
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'cyan') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
p4a
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
p4b
grid.arrange(arrangeGrob(p4a, p4b), nrow =1)
grid.arrange(arrangeGrob(p4a, p4b), ncol = 2)
grid.arrange(p4a,p4b)
grid.arrange(p4a, p4b, nrows =1)
grid.arrange(p4a, p4b, nrows =1)
grid.arrange(grobs = c(p4a, p4b), nrow =1)
grid.arrange(grobs = gs[1:2], ncol =2)
grid.arrange(p4a, p4b, nrow = 2, heights = c(0.35, 0.65))
grid.arrange(p4a, p4b, nrow = 2)
grid.arrange(p4a, p4b, ncol = 2)
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
?geom_smooth
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, meathod = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, ncol = 2)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, ncol = 2)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "lm") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, ncol = 2)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25) +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, ncol = 2)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25,method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps") +
geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, ncol = 2)
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
smooth_vals4a = predict(loess(interval~sum,weekdays), weekdays$sum)
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25,method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps")
grid.arrange(p4a, p4b, ncol = 2)
smooth_vals4b = predict(loess(interval~sum,weekend), weekend$sum
)
diffDays = predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum)
diffDays = dat.frame(predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum))
diffDays = data.frame(predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum))
View(diffDays)
names(diffDays) <- c('difference')
cbind(diffDays, weekend$interval[drop=FALSE])
diffDays <- cbind(diffDays, weekend[,2])
diffDays <- cbind(diffDays, weekend[,1])
diffDays <- data.frame(predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum))
names(diffDays) <- c('difference')
diffDays <- cbind(diffDays, weekend[,1])
diffDays <- data.frame(predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum))
names(diffDays) <- c('difference')
diffDays <- cbind(weekend[,1],diffDays)
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area()
p5
grid.arrange(p4a, p4b, ncol = 2)
diffDays %>% mutate(format(as.POSIXct(Sys.Date()) + diffDays$interval*60, format="%H:%M:%S", tz="UCT"))
diffDays <- mutate(format(as.POSIXct(Sys.Date()) + diffDays$interval*60, format="%H:%M:%S", tz="UCT"))
diffDays <- format(as.POSIXct(Sys.Date()) + diffDays$interval*60, format="%H:%M:%S", tz="UCT")
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(stat ="bin")
diffDays <- data.frame(predict(loess(interval~sum,weekdays), weekdays$sum) -
predict(loess(interval~sum,weekend), weekend$sum))
names(diffDays) <- c('difference')
diffDays <- cbind(weekend[,1],diffDays)
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(stat ="bin")
p5
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(alpha=0.6) +
theme_classic()
p5
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(color="darkblue",
fill="lightblue")
p5
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(color="darkblue",
fill="lightblue")+
labs(title="Difference Between Weekday and Weekend Average Steps Per 5-Minute Time Interval",
x="5 Minute time interval", y = "Difference of Average Number of Steps (Weekday - Weekend)")
p5
p4 <- grid.arrange(p4a, p4b, ncol = 2)
p4 <- ggplotly(p4)
p4
p4 <- grid.arrange(p4a, p4b, ncol = 2)
p4
grid.arrange(p4a, p4b, ncol = 2)
p4c <- ggplotly(p4)
p4a1 <- ggplotly(p4a)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a1, p4b1)
p4c
p4a1 <- ggplotly(p4a)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE)
p4c
p4 <- grid.arrange(p4a, p4b, ncol = 2)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE)
p4c
p5 <- ggplot(diffDays, aes(x = interval, y = difference)) + geom_area(color="darkblue",
fill="lightblue")+
labs(title="Difference Between Weekday and Weekend Average Steps Per 5-Minute Time Interval",
x="5 Minute time interval", y = "Difference of Average Number of Steps (Weekday - Weekend)")
p5 <- ggplotly(p5)
p5
plotly(smooth_vals4a)
smootha <- cbind(weekend[,1],smooth_vals4a)
View(smootha)
plotly(smootha, x = ~interval,y = ~smooth_vals4a)
plotly(smootha)
plotly(smootha, x  = interval)
plot_ly(smootha, x = ~interval,y = ~smooth_vals4a)
plot_ly(smootha, x = ~interval,y = ~smooth_vals4a, mode = lines)
plot_ly(smootha, x = ~interval,y = ~smooth_vals4a, mode = lines, type = scatter)
plot_ly(smootha, x = ~interval,y = ~smooth_vals4a, mode = 'lines', type = 'scatter')
p4c
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'lightblue') + geom_smooth(span = 0.25,method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps")
p4 <- grid.arrange(p4a, p4b, ncol = 2)
p4a1 <- ggplotly(p4a)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE)
p4c
p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekday",
x="5 Minute time interval", y = "Average Number of Steps")
p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
geom_line( size = 1, colour = 'green') + geom_smooth(span = 0.25,method = "loess") +
labs(title="Average Steps Per 5-Minute Time Interval Weekend",
x="5 Minute time interval", y = "Average Number of Steps")
p4 <- grid.arrange(p4a, p4b, ncol = 2)
p4a1 <- ggplotly(p4a)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE)
p4c
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE, legend = TRUE)
p4c
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = F)
p4c
p4a1 <- ggplotly(p4a) %>% layout(annotations = d)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = F)
p4c
d <- list(
text = "Task 4",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
p4a1 <- ggplotly(p4a) %>% layout(annotations = d)
p4b1 <- ggplotly(p4b)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = F)
p4c
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = F, annotations = d)
p4c
p4a1 <- ggplotly(p4a) %>% layout(annotations = d)
p41a
p4a1
p4a1 <- ggplotly(p4a) %>% layout(annotations = d)
p4b1 <- ggplotly(p4b) %>% layout(annotations = d)
p4c <- subplot(p4a, p4b, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = T)
p4c
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = T)
p4c
p4a1 <- ggplotly(p4a) %>% layout(annotations = d, showlegend = TRUE)
p4b1 <- ggplotly(p4b) %>% layout(annotations = d, showlegend = TRUE)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = TRUE)
p4c
titlea <- list(
text = "Weekday",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
titleb <- list(
text = "Weekend",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
p4a1 <- ggplotly(p4a) %>% layout(annotations = titlea, showlegend = TRUE)
p4b1 <- ggplotly(p4b) %>% layout(annotations = titleb, showlegend = TRUE)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = TRUE)
p4c
4a <- qplot(sum, interval, data = weekdays,alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
grid.arrange(p4a, p4b, nrow =1)
# p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekday",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
#
# p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'green') + geom_smooth(span = 0.25,method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekend",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
# p4 <- grid.arrange(p4a, p4b, ncol = 2)
titlea <- list(
text = "Weekday",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
titleb <- list(
text = "Weekend",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
p4a1 <- ggplotly(p4a) %>% layout(annotations = titlea, showlegend = TRUE)
p4b1 <- ggplotly(p4b) %>% layout(annotations = titleb, showlegend = TRUE)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = TRUE)
p4c
library(lubridate)
library(stringr)
dataDate <- data %>% mutate(date = as.Date(date, format = "%Y-%m-%d"))
daysOfWeek <- dataDate %>% mutate(day = weekdays(date, abbreviate = FALSE)) %>%
mutate(type = str_detect(day, "Saturday|Sunday")) %>%
mutate(type = factor(type, levels = c(FALSE,TRUE), labels = c('weekday','weekend')))
weekdays <- daysOfWeek %>% filter(type == "weekday") %>% group_by(interval) %>%
mutate(steps = na.aggregate(steps, by = interval,FUN = median)) %>%
summarise(sum = sum(steps))
weekend <- daysOfWeek %>% filter(type == "weekend") %>% group_by(interval) %>%
mutate(steps = na.aggregate(steps, by = interval,FUN = median)) %>%
summarise(sum = sum(steps))
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/10)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
# p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekday",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
#
# p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'green') + geom_smooth(span = 0.25,method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekend",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
# p4 <- grid.arrange(p4a, p4b, ncol = 2)
titlea <- list(
text = "Weekday",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
titleb <- list(
text = "Weekend",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
p4a1 <- ggplotly(p4a) %>% layout(annotations = titlea, showlegend = TRUE)
p4b1 <- ggplotly(p4b) %>% layout(annotations = titleb, showlegend = TRUE)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = TRUE)
p4c
p4a <- qplot(sum, interval, data = weekdays,alpha = I(1/1000)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekday", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
p4b <- qplot(sum, interval, data = weekend, alpha = I(1/1000)) + geom_line( size = 1, colour = 'firebrick') +
labs(title="Average Steps Per 5-Minute Time Interval Weekend", x="5 Minute time interval",
y = "Average Number of Steps") + geom_smooth(span = 0.25)
# p4a <- ggplot(data = weekdays, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'firebrick') + geom_smooth(span = 0.25, method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekday",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
#
# p4b <- ggplot(data = weekend, aes(x = interval, y = sum, group = 1)) +
#         geom_line( size = 1, colour = 'green') + geom_smooth(span = 0.25,method = "loess") +
#         labs(title="Average Steps Per 5-Minute Time Interval Weekend",
#              x="5 Minute time interval", y = "Average Number of Steps")
#
#
# p4 <- grid.arrange(p4a, p4b, ncol = 2)
titlea <- list(
text = "Weekday",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
titleb <- list(
text = "Weekend",
size = 50,
xref = "paper",
yref = "paper",
yanchor = "bottom",
xanchor = "center",
align = "center",
x = 0.5,
y = 1,
showarrow = FALSE
)
p4a1 <- ggplotly(p4a) %>% layout(annotations = titlea, showlegend = TRUE)
p4b1 <- ggplotly(p4b) %>% layout(annotations = titleb, showlegend = TRUE)
p4c <- subplot(p4a1, p4b1, shareX = TRUE, shareY = TRUE) %>% layout(showlegend = TRUE)
p4c
